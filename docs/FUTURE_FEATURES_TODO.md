# 🚀 Future Features TODO

> **현재 상태**: 기본 로그인 + 데이터 동기화 완료  
> **목표**: 나중에 필요할 수 있는 기능들을 체계적으로 정리

---

## 📋 현재 완료된 기능

### ✅ **기본 인증 시스템**

- [x] 구글 OAuth 로그인
- [x] Supabase `auth.users` 테이블 자동 저장
- [x] 로그아웃 기능
- [x] 세션 관리

### ✅ **데이터 동기화 시스템**

- [x] `user_data` 테이블 (JSONB)
- [x] 크로스 브라우저 데이터 동기화
- [x] 사용자 중심 동기화 모달 (Import data vs Start fresh, Device data vs Server data)
- [x] 자동 충돌 해결
- [x] `localStorage` ↔ Supabase 동기화
- [x] **Realtime 구독 임시 비활성화** (WebSocket 연결 문제로 인한 안정성 확보)

### ✅ **Migration 시스템**

- [x] SQL 실행 기록 (`migration_log`)
- [x] 롤백 지원
- [x] 상태 추적
- [x] 한국시간(KST) 지원

---

## 🔮 나중에 필요할 수 있는 기능들

### 🎯 **1. Realtime 데이터 동기화 시스템 재구축**

#### **필요한 이유:**

- **다중 기기 사용 시나리오**: 사용자가 PC와 모바일에서 동시에 시간표를 관리할 때 실시간 동기화 필요
- **협업 환경**: 여러 교사가 같은 시간표를 공유하거나 관리할 때 실시간 업데이트 필요
- **데이터 일관성**: 네트워크 문제나 앱 크래시로 인한 데이터 손실 방지
- **사용자 경험 향상**: 수동 새로고침 없이 자동으로 최신 데이터 반영

#### **현재 상황:**

- **임시 비활성화**: WebSocket 연결 실패로 인한 무한 루프 및 콘솔 에러 발생
- **안정성 우선**: 현재는 로그인 시 동기화로 충분히 작동
- **단일 사용자 환경**: 대부분의 사용자가 한 기기에서만 사용

#### **구현 시 고려사항:**

- [ ] **Supabase Realtime 설정 확인**: `user_data` 테이블의 Realtime 기능 활성화
- [ ] **WebSocket 연결 안정성**: 네트워크 불안정 시 재연결 로직 구현
- [ ] **에러 처리 강화**: 연결 실패 시 폴백 메커니즘 제공
- [ ] **성능 최적화**: 불필요한 재연결 방지 및 메모리 누수 방지
- [ ] **사용자 선택권**: Realtime 동기화 활성화/비활성화 옵션 제공

#### **구현 시 가능한 것:**

- [ ] **실시간 데이터 동기화**: 다른 기기에서 변경한 데이터 즉시 반영
- [ ] **충돌 해결**: 동시 편집 시 자동 충돌 해결 또는 사용자 선택 제공
- [ ] **오프라인 지원**: 네트워크 복구 시 자동 동기화
- [ ] **다중 사용자 협업**: 여러 사용자가 동시에 시간표 편집
- [ ] **변경 히스토리**: 데이터 변경 이력 추적 및 롤백 기능

#### **기술적 구현 방향:**

```typescript
// 향후 구현 예시
const useRealtimeSync = () => {
  useEffect(() => {
    const channel = supabase
      .channel('user_data_changes')
      .on(
        'postgres_changes',
        {
          event: '*',
          schema: 'public',
          table: 'user_data',
          filter: `user_id=eq.${user.id}`,
        },
        payload => {
          // 안전한 데이터 동기화 로직
          handleRealtimeUpdate(payload);
        }
      )
      .subscribe(status => {
        if (status === 'SUBSCRIBED') {
          console.log('✅ Realtime 구독 성공');
        } else if (status === 'CHANNEL_ERROR') {
          console.log('❌ Realtime 구독 실패 - 폴링 모드로 전환');
          enablePollingMode();
        }
      });

    return () => supabase.removeChannel(channel);
  }, [user]);
};
```

#### **우선순위:**

- **낮음**: 현재 앱의 사용 패턴상 급하지 않음
- **조건부**: 다중 기기 사용자 증가 시 재검토
- **안정성 우선**: WebSocket 연결 문제 완전 해결 후 구현

---

### 🎯 **2. 사용자 프로필 관리 시스템**

#### **필요한 이유:**

- 개인화된 사용자 경험
- 사용자별 설정 관리
- 아바타, 이름 등 개인 정보

#### **구현 시 가능한 것:**

- [ ] 사용자 이름 표시
- [ ] 프로필 아바타 설정
- [ ] 개인 정보 수정
- [ ] 사용자별 테마 설정
- [ ] 언어 설정

#### **구현 시 불가능한 것:**

- 현재는 이메일만으로 식별
- 개인화된 UI 제공 불가
- 사용자별 설정 저장 불가

#### **필요한 테이블:**

- `user_profiles` (이미 생성됨)
- `user_settings` (이미 생성됨)

---

### 💰 **2. 유료화 및 구독 관리 시스템**

#### **필요한 이유:**

- 수익 모델 구축
- 사용자별 기능 제한
- 구독 상태 관리

#### **구현 시 가능한 것:**

- [ ] 학생 수 제한 (무료: 10명, 유료: 무제한)
- [ ] 구독 상태별 기능 차별화
- [ ] 결제 시스템 연동
- [ ] 구독 만료 알림
- [ ] 구독 갱신 관리

#### **구현 시 불가능한 것:**

- 현재는 학생 수 제한 없음
- 구독 상태별 기능 차별화 불가
- 수익 모델 구축 불가

#### **필요한 테이블:**

- `user_profiles` (subscription_type, student_limit)
- `subscriptions` (새로 생성 필요)
- `payments` (새로 생성 필요)

---

### �� **3. 사용자 활동 추적 시스템**

#### **필요한 이유:**

- 사용자 행동 분석
- 보안 로그 관리
- 사용 패턴 파악

#### **구현 시 가능한 것:**

- [ ] 로그인/로그아웃 기록
- [ ] 데이터 동기화 기록
- [ ] 사용자 행동 패턴 분석
- [ ] 보안 이벤트 추적
- [ ] 사용 통계 제공

#### **구현 시 불가능한 것:**

- 현재는 사용자 활동 기록 없음
- 보안 이벤트 추적 불가
- 사용 패턴 분석 불가

#### **필요한 테이블:**

- `user_activity_logs` (이미 생성됨)

---

### �� **4. 사용자 역할 및 권한 관리**

#### **필요한 이유:**

- 다중 사용자 환경 지원
- 권한별 기능 제한
- 관리자 기능 제공

#### **구현 시 가능한 것:**

- [ ] 역할별 기능 차별화 (학생/선생님/관리자)
- [ ] 권한 기반 접근 제어
- [ ] 관리자 대시보드
- [ ] 사용자 관리 기능
- [ ] 시스템 설정 관리

#### **구현 시 불가능한 것:**

- 현재는 모든 사용자가 동일한 권한
- 역할별 기능 차별화 불가
- 관리자 기능 제공 불가

#### **필요한 테이블:**

- `user_profiles` (role 필드)
- `permissions` (새로 생성 필요)

---

### 📊 **5. 데이터 분석 및 통계 시스템**

#### **필요한 이유:**

- 사용자 행동 분석
- 서비스 개선 데이터
- 비즈니스 인사이트

#### **구현 시 가능한 것:**

- [ ] 사용자 통계 대시보드
- [ ] 데이터 사용량 분석
- [ ] 사용 패턴 시각화
- [ ] 성능 메트릭 추적
- [ ] 사용자 만족도 조사

#### **구현 시 불가능한 것:**

- 현재는 통계 데이터 수집 없음
- 사용 패턴 분석 불가
- 성능 메트릭 추적 불가

#### **필요한 테이블:**

- `analytics_events` (새로 생성 필요)
- `user_metrics` (새로 생성 필요)

---

### 🔔 **6. 알림 및 커뮤니케이션 시스템**

#### **필요한 이유:**

- 사용자 참여도 향상
- 중요한 이벤트 알림
- 고객 지원

#### **구현 시 가능한 것:**

- [ ] 이메일 알림
- [ ] 푸시 알림
- [ ] SMS 알림
- [ ] 인앱 알림
- [ ] 구독 만료 알림

#### **구현 시 불가능한 것:**

- 현재는 알림 시스템 없음
- 사용자 참여도 향상 불가
- 고객 지원 기능 불가

#### **필요한 테이블:**

- `notifications` (새로 생성 필요)
- `notification_settings` (새로 생성 필요)

---

## 🎯 **우선순위별 구현 계획**

### **Phase 1: 기본 기능 완성** (현재)

- [x] 로그인/로그아웃
- [x] 데이터 동기화
- [x] 기본 CRUD 기능

### **Phase 2: 사용자 경험 개선** (다음)

- [ ] 사용자 프로필 관리
- [ ] 개인화 설정
- [ ] 사용자 활동 추적

### **Phase 3: 비즈니스 모델** (나중)

- [ ] 유료화 시스템
- [ ] 구독 관리
- [ ] 결제 시스템

### **Phase 4: 고급 기능** (미래)

- [ ] 역할 및 권한 관리
- [ ] 데이터 분석
- [ ] 알림 시스템

---

## 📝 **구현 시 주의사항**

### **데이터베이스 변경:**

- 기존 테이블 수정 시 Migration 필수
- RLS 정책 재설정 필요
- Realtime 구독 재설정 필요

### **프론트엔드 변경:**

- 새로운 컴포넌트 추가
- 상태 관리 로직 수정
- API 호출 로직 추가

### **보안 고려사항:**

- 사용자 데이터 보호
- 결제 정보 보안
- 개인정보 처리 방침

---

## 🔗 **관련 문서**

- [DEVELOPER_GUIDE.md](./DEVELOPER_GUIDE.md) - 개발자 가이드
- [MIGRATION_GUIDE.md](./MIGRATION_GUIDE.md) - Migration 가이드
- [SUPABASE_JSONB_GUIDE.md](./SUPABASE_JSONB_GUIDE.md) - Supabase 가이드

---

## 📅 **업데이트 기록**

- **2025-01-06**: 초기 문서 생성
- **현재 상태**: 기본 로그인 + 데이터 동기화 완료
- **2024-01-XX**: Realtime 구독 비활성화 (WebSocket 연결 문제 해결)
- **다음 목표**: 사용자 프로필 관리 시스템 구현

---

## 🔧 기술적 부채 및 임시 조치

### **Realtime 구독 비활성화 (2024-01-XX)**

#### **상황:**

- WebSocket 연결 실패로 인한 무한 루프 발생
- `WebSocket connection to '<URL>' failed: WebSocket is closed before the connection is established` 에러 반복
- 콘솔 로그 과다 출력으로 인한 성능 저하

#### **임시 조치:**

- `useDataSync.ts`에서 Realtime 구독 완전 비활성화
- 로그인 시 동기화 방식으로 대체
- 앱 안정성 확보

#### **복구 조건:**

1. Supabase Realtime 설정 확인 및 수정
2. WebSocket 연결 안정성 확보
3. 에러 처리 및 폴백 메커니즘 구현
4. 다중 기기 사용자 증가 시 재검토

#### **영향:**

- **긍정적**: 앱 안정성 향상, 콘솔 에러 제거
- **부정적**: 실시간 동기화 기능 상실 (현재 사용 패턴상 영향 미미)

#### **관련 파일:**

- `src/hooks/useDataSync.ts`: Realtime 구독 로직 비활성화
- `src/utils/supabaseClient.ts`: Supabase 클라이언트 설정
- `docs/DEVELOPER_GUIDE.md`: 문제 해결 가이드 업데이트

---

> **참고**: 이 문서는 프로젝트의 미래 기능들을 체계적으로 정리한 것입니다.  
> 각 기능의 필요성과 구현 시점은 프로젝트의 발전 단계에 따라 결정됩니다.
