<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <link rel="icon" type="image/svg+xml" href="/class_planner/vite.svg" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>í´ë˜ìŠ¤ í”Œë˜ë„ˆ</title>
    
    <!-- GitHub Pages SPA ë¼ìš°íŒ… ìŠ¤í¬ë¦½íŠ¸ -->
    <script type="text/javascript">
      (function(l) {
        if (l.search[1] === '/' ) {
          var decoded = l.search.slice(1).split('&').map(function(s) { 
            return s.replace(/~and~/g, '&')
          }).join('?');
          window.history.replaceState(null, null,
              l.pathname.slice(0, -1) + decoded + l.hash
          );
        }
      }(window.location))
    </script>
    <script type="module" crossorigin src="/class_planner/assets/index-DLIAOY9L.js"></script>
    <link rel="stylesheet" crossorigin href="/class_planner/assets/index-B0IgrTuz.css">
  </head>
  <body>
    <div id="root"></div>

    <!-- localStorage ë°±ì—…/ë³µì› ìœ í‹¸ë¦¬í‹° -->
    <script>
      // localStorage ë°±ì—…/ë³µì› ìœ í‹¸ë¦¬í‹° ìŠ¤í¬ë¦½íŠ¸
      const LocalStorageManager = {
        // í˜„ì¬ localStorage ë°ì´í„° ë°±ì—…
        backup() {
          const backup = {
            timestamp: new Date().toISOString(),
            data: {
              students: JSON.parse(localStorage.getItem('students') || '[]'),
              subjects: JSON.parse(localStorage.getItem('subjects') || '[]'),
              enrollments: JSON.parse(
                localStorage.getItem('enrollments') || '[]'
              ),
              selectedStudent: localStorage.getItem('ui:selectedStudent') || '',
            },
          };

          console.log('ğŸ“‹ ë°±ì—… ì™„ë£Œ:', backup);

          // JSONìœ¼ë¡œ ë³€í™˜í•˜ì—¬ í´ë¦½ë³´ë“œì— ë³µì‚¬
          const backupJson = JSON.stringify(backup, null, 2);
          navigator.clipboard
            .writeText(backupJson)
            .then(() => {
              console.log('âœ… ë°±ì—… ë°ì´í„°ê°€ í´ë¦½ë³´ë“œì— ë³µì‚¬ë˜ì—ˆìŠµë‹ˆë‹¤!');
              console.log('ğŸ’¡ ì´ ë°ì´í„°ë¥¼ ì•ˆì „í•œ ê³³ì— ì €ì¥í•´ë‘ì„¸ìš”.');
            })
            .catch(() => {
              console.log('ğŸ“„ ë°±ì—… JSON (ìˆ˜ë™ ë³µì‚¬):', backupJson);
            });

          return backup;
        },

        // ë°±ì—… ë°ì´í„° ë³µì›
        restore(backupData) {
          try {
            if (typeof backupData === 'string') {
              backupData = JSON.parse(backupData);
            }

            const { data } = backupData;

            // localStorageì— ë³µì›
            Object.entries(data).forEach(([key, value]) => {
              if (key === 'selectedStudent') {
                localStorage.setItem('ui:selectedStudent', value);
              } else {
                localStorage.setItem(key, JSON.stringify(value));
              }
            });

            console.log('âœ… ë°±ì—… ë°ì´í„°ê°€ ì„±ê³µì ìœ¼ë¡œ ë³µì›ë˜ì—ˆìŠµë‹ˆë‹¤!');
            console.log('ğŸ”„ í˜ì´ì§€ë¥¼ ìƒˆë¡œê³ ì¹¨í•˜ì„¸ìš”.');

            return true;
          } catch (error) {
            console.error('âŒ ë³µì› ì‹¤íŒ¨:', error);
            return false;
          }
        },

        // í˜„ì¬ localStorage ìƒíƒœ í™•ì¸
        status() {
          const status = {
            students: JSON.parse(localStorage.getItem('students') || '[]'),
            subjects: JSON.parse(localStorage.getItem('subjects') || '[]'),
            enrollments: JSON.parse(
              localStorage.getItem('enrollments') || '[]'
            ),
            selectedStudent: localStorage.getItem('ui:selectedStudent') || '',
          };

          console.log('ğŸ“Š í˜„ì¬ localStorage ìƒíƒœ:', status);
          console.log(`ğŸ“š í•™ìƒ: ${status.students.length}ëª…`);
          console.log(`ğŸ“– ê³¼ëª©: ${status.subjects.length}ê°œ`);
          console.log(`â° ìˆ˜ì—…: ${status.enrollments.length}ê°œ`);

          return status;
        },

        // localStorage ì´ˆê¸°í™” (ì£¼ì˜!)
        clear() {
          if (confirm('âš ï¸ ì •ë§ë¡œ ëª¨ë“  ë°ì´í„°ë¥¼ ì‚­ì œí•˜ì‹œê² ìŠµë‹ˆê¹Œ?')) {
            localStorage.clear();
            console.log('ğŸ—‘ï¸ localStorageê°€ ì´ˆê¸°í™”ë˜ì—ˆìŠµë‹ˆë‹¤.');
            return true;
          }
          return false;
        },

        // íŠ¹ì • í‚¤ë§Œ ì‚­ì œ
        remove(key) {
          if (localStorage.getItem(key)) {
            localStorage.removeItem(key);
            console.log(`ğŸ—‘ï¸ ${key}ê°€ ì‚­ì œë˜ì—ˆìŠµë‹ˆë‹¤.`);
            return true;
          } else {
            console.log(`âŒ ${key}ë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.`);
            return false;
          }
        },
      };

      // ì „ì—­ ê°ì²´ë¡œ ë“±ë¡
      window.LocalStorageManager = LocalStorageManager;

      console.log('ğŸš€ LocalStorageManagerê°€ ë¡œë“œë˜ì—ˆìŠµë‹ˆë‹¤!');
      console.log('ì‚¬ìš©ë²•:');
      console.log('- LocalStorageManager.backup() : ë°ì´í„° ë°±ì—…');
      console.log('- LocalStorageManager.restore(backupData) : ë°ì´í„° ë³µì›');
      console.log('- LocalStorageManager.status() : í˜„ì¬ ìƒíƒœ í™•ì¸');
      console.log('- LocalStorageManager.clear() : ëª¨ë“  ë°ì´í„° ì‚­ì œ');
      console.log('- LocalStorageManager.remove(key) : íŠ¹ì • í‚¤ ì‚­ì œ');
    </script>
  </body>
</html>
